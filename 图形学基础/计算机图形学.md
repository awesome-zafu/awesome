####第一章
**计算机图形学:**是研究怎样利用计算机来显示、生成和处理图像原理、方法的一门学科。

P.S.研究的对象是图形

图形学的基本要素：

1. 刻画形状的点、线、面等几何要素。
2. 反应物体本身固有属性，如表面属性或者材质的明暗、灰度、色彩等非几何要素

表示带有色彩及形状信息的图和形常用的两种方法：**点阵法**和**参数法**。

把**参数法**描述的图形叫做**图形**。
把**点阵法**描述的图形叫做**图像**。

图像是指计算机内以位图形式存在的灰度信息,而图形则含有几何属性,或者说更强调场景的几 何表示,是由场景的几何模型和景物的物理属性共同组成的。

####第二章

计算机图形系统的功能：

1. 计算功能
2. 存储功能
3. 交互功能
4. 输入功能
5. 输出功能

计算机图形系统的结构
图1

图形软件主要分为：**图形应用数据结构**、**图形应用软件**和**图形支撑软件**。

图形输入设备：键盘、鼠标器、光笔、触摸屏、操纵杆、跟踪球和空间球、数据手套、数字化仪、图像扫描仪、声频输入系统、视频输入系统。

图形显示设备：

1. 阴极射线管
	- 电子枪：产生一个沿着管轴（z轴）方向前进的细电子束，用于轰击荧光屏。要求：
		- 具有足够的电流强度
		- 电流大小和有无必须是可控的
		- 具有很高的速度
		- 在荧光屏上应能聚焦很小的光亮，以保证显示器有足够的分辨率
	- 偏转系统：
		- 磁偏转：保证CRT图形的清晰度
		- 电偏转：朝带正高电压的极板偏转
	- CRT的荧光屏：用荧光粉涂敷在玻璃底壁上制成的。
	- 彩色阴极射线管:荧光粉由RGB3种，射线也有RGB3种

2. CRT图形显示器：
	- 随机扫描显示器：只在需要的地方扫描，不必全屏扫描。又称为向量显示器，笔画显示器。
	- 直视存储管图形显示器：存在收集栅和存储栅：由于暂存，这样可以长时间显示一副图片，不过如果要重新显示新的图片就需要一段时间
	- 光栅扫描图形显示器：最广泛的CRT图形显示器
		- 回扫的模式：
			- 水平回扫
			- 垂直回扫
		- 扫描方法：
			- 隔行扫描，从左到右，结束后返回最开始的地方。隔行扫描可以在一般的时间内，可以观察到整个屏幕的显示
			- 逐行扫描

分辨率：像素点是光点的集合，光点是电子书在显示器上能够显示的最小发光点。像素点是图形显示分辨率所能提供的最小像素点。

- 屏幕分辨率：最大可能的分辨率
- 显示分辨率：显示模式一般用水平方向乘垂直方向上显示的字符总数的乘积。
- 存储分辨率：帧缓冲存储区的大小：** 计算方法：x方向上的像素点数 * y方向上的存储点数 * (log2 2^n )/ 8** 2^n ^为色彩，如黑白为2^1 ^, 256色为2^8^

####第四章：
基本图形元素：

- 点：点事0维几何元素，是形体的基本元素，一维中为一元组，二维中为二元组，三位中为三元组。
- 线：线是一维几何元素，曲线由一系列型值点或控制点表示
- 面：是二维几何元素，可以无内环，但是必须有外环，其外法线适量方向作为该面的正向。
- 环：最大边界的环成为外环，外环逆时针方向排序，内环为顺时针方向排序。
- 体：三维几何元素。

几何信息与拓扑信息：

- 点：（x,y,z）
- 直线：x = (y - y0)/a = (z - z0)/b
- 平面：ax+by+cz+b = 0

拓扑信息：因为形体的表示出了需要集合信息以外，还应该提供分量之间的互相联系的关系，即**拓扑信息**

坐标系：

- 建模坐标系：定义基本形体或图素。可看做局部坐标系
- 用户坐标系：定义用户的整图结构或最高层图像结构，根据情况选择不同坐标系。一般称为全局坐标系（相对建模坐标系而言）
- 观察坐标系：指定裁剪控件，定义观察平面，把三位形体的用户坐标变换成规格化的设备坐标。
- 规格化的设备坐标，用来定义视图区，一般为（0,0,0）到（1,1,1）之间
- 设备坐标系(DC)，是图形输入/输出设备的坐标系。

**欧拉公式：V(简单多面体的顶点数)-E(边数)+F(面数目)=2**

**拓展后的欧拉公式：V-E+F-H(孔的个数)=2(C(独立不想连接的多面体数目))-G(贯穿的多面体孔的个数))**

三位形体表示缺陷：

1. 有二义性
2. 不存在面的信息
3. 不能表示出曲面的轮廓线

实体模型表示一般分为3类：

1. 边界表示，用一组曲面来表示
2. 构造实体几何表示，立方体、长方体、圆柱体、圆锥体等的基本体素的交并差等运算。
3. 控件分割表示，划分成为一组小的菲重叠的连续实体

多边形表面模型：

- 数据结构：
	- 根据点线，线面的关系退出Ax+By+Cz+D = 0中的ABC，从而更加方便的推算出一点点是否在空间内。
	- 拓扑信息：翼边结构
	- 属性信息
- 多边形网络
- 八叉树（用F(全覆盖)B(部分覆盖)E(完全没有覆盖)来表示），把B不断细分，知道不出现B为止


####第五章
直线扫描转换要求：

1. 直线要直
2. 直线端点要准确
3. 直线的亮度、颜色要均匀
4. 划线的速度要尽可能快

**数值微分算法：不利于硬件实现**

思路：每一个点基于所在直线的极限值

1. 首先比较dx和dy之间哪个哪个更大，更大的说明往那个方向为基准，另一份方向上+0或者+1
2. 其次epls为dx，dy中最大的那个值
3. dx，dy分别处以epls从而获得递进量
4. 画点的时候，较小的那个值在原值（即极限直线上的值+0.5）
5. x和y分别增加对应的递进量
6. 重复4，5步，直到直线画完


```
void DDALine(int x0,int y0,int x1,int y1,int color){
	int x;
	float dx,dy,y,k;
	dx=x1-x0;
	dy=y1-y0;
	k=dy/dx;
	y=y0;
	for(x=x0;x<=x1;x++){
	drawpixel(x,int(y+0.5),color);
	y=y+k;
	}
}
```
**中点Bresenham算法**

思路：每一个点基于上一个点的d的值

1. 输入两个端点
2. 计算初始值dx，dy，d=dx-2dy,x=x0,y=y0
3. 判断d的值，如果d<0,那么(x,y)为(x+1,y+1),d = d+2dx-2dy,否则(x,y)为(x+1,y),d = d-2dy
4. 重复3，直到直线结束

```
void MidBresenhamLine(int x0,int y0,int x1,int y1,int color)
{
	int dx,dy,d,UpIncre,DownIncre,x,y;
	//更换x，y起始点位置
	if(x0 > x1){
		x = x1;x1 = x0;x0 = x;
		y = y1;y1 = y0;y0 = y;
	}
	x = x0;y = y0;
	dx = x1-x0;dy = y1 - y0;
	d = dx - 2*dy;
	UpIncre = 2 * dx - 2 * dy; DownIncre = -2 * dy
	while(x <= x1){
		putpixel(x,y,color);
		x++;
		if(d<0){
			y++;
			d+=UpIncre;
		}else{
			d += DownIncre
		}
	}

}

```
**改进Bresenham算法**

思路：制作虚拟网格线，结合上面两个方面在每一步的时候都是根据上一步进行计算，不过d的值每次增加k，如果d大于1，则d-1，否则不变。

```
void  BresenhamLine(int x0,int y0,int x1,int y1,int color){
	int x,y,dx,dy,e;
	dx = x1 - x0;
	dy = y1 - y0;
	e = -dx;x = x0;y = y0;
	while(x < x1){
		putpixel(x,y,color);
		x++;
		e=e+2*dy;
		if(e>0){
			y++;
			e=e-2*dx
		}
	}	
}

```

八分法画圆，通过计算一个区域的x,y，然后通过绘制(x,y),(-x,y),(x,-y),(-x,-y),(y,x),(-y,x),(y,-x),(-y,-x)

**多边形扫描算法：**

- x-扫描线算法：按照线扫描线的顺序，计算扫描线与多边形的相交区间，在用要求的颜色显示这些区间的像素，即完成填充工作。区间的端点可以通过计算扫描线与多边形边界线的焦点获得。
	- 取整：当该交点处于区间的左边界上的时候，x坐标向右取整，当该交点处于区间的右边界上的时候，x坐标向左取整。
	- 步骤：
		1. 求交点
		2. 排序
		3. 焦点配对，找到对应的相交区间
		4. 区间填色。
- 改进的有效边表算法
	- 有效边表的节点：|x|ymax|1/k|next|
	- 为了有效边表的构造，需要构造一个边表，来存放多边形除水平边外的所有边的信息
	- 桶：边表上纵向列表上的每个节点
	- 通过分离某些变缩短以分离那些应计为一个交点的顶点。
	- 算法的步骤：
		1. 初始化，构造边表，AET表置空
		2. 降低一个ET表的边与AET表合并
		3. 由AET表中取出焦点并进行填充，填充的时候设置一个布尔值（初值为假），令指针从有效边表中第一个节点（交点）到最后一个节点遍历一次。每访问一个节点，把b取反一次，若b为真，则把从前节点的x值开始到下一节点的x值结束的区间用多边形色填充，填充后删除y=ymax的边。
		4. yi+1 = yi + 1，根据x+1 = xi +1/k计算修改AET表，同时合并ET表中y = yi+1桶中的边，按次序插入到AET表中，形成新的AET表
		5. AET表不为空转到3，否则结束
- 区域填充
	- 概念： 
		- 种子点：从区域中的一点（用户指定的一点）开始，由该点向外扩展
		- 4-邻接点：一个点与其上、下、左、右4个相邻的店
		- 8-邻接点：一个点与其上、下、左、右、左上、右上、左下、右下8个相邻的店
		- 4-连通区域：访问区域内已知点的4-邻接点来遍历整个区域
		- 8-连通区域：访问区域内已知点的8-邻接点来遍历整个区域，8连通区域的边界一定是4-连通的。
	- 填充算法
		- 边界填充算法：为了解决直接使用4-连通边界填充算法导致效率低下和要求大量的储存空间
			- 种子像素入栈
			- 栈顶像素出栈，填充像素所在扫描行，直到遇到边界像素为止。并记录下扫描区间的x坐标范围[x1,x2],然后检查上下两条扫描线上位于[x1,x2]坐标区间内的未被填充的连续水平像素段，将每个连续像素段的最左像素取做种子像素压入堆栈。
			- 检查栈是否为空，若非空，则重复进行步骤2，直到栈为空。
		
		- 泛填充算法：主要是为了给区域重新着色，
			1. 种子像素入栈
			2. 栈顶像素出栈，将出栈的死昂素置成填充色，检查出栈像素的4-邻接点，若其中某个像素点是给定内部点的颜色，则把该像素入栈。
			3. 检查栈是否为空，若栈非空则重复步骤2，否则结束
			
	> 其中在边界上时候，4-连通边界算法只能填充4-连通区域，8-x只能填充8-y,而用内点表示的时候8-x可以填充4-y，8-y，而4-x只能填充4-x。
			
- 内外测试
	- 概念：主要用于测试对象在内部区域还是外部区域
	- 奇偶规则的测试方法：
		1. 在区域内取一点P
		2. 以该点做一条射线（射线不与各种线的交点相交）
		3. 如果交点个数为偶数，则该点在区域外；如果交点个数为基数，则该点在区域内。
	- 非零环绕数规则
		1. 按照逆时针方向对多边形的顶点进行排序。使得多边形的变变为矢量，然后将环绕数初始化为0。
		2. 在从测试区域的任意位置做点P，做一条射线（该射线不与任何多边形顶点相交）。
		3. P沿射线方向移动的时候，对在每个方向上穿过射线的边进行计数，每当从右到左传国涉嫌时候，环绕数+1，否则-1，处理完后，环绕数为0则为外部，否则为内部。
	- 这两种方法会产生不同的内外部的效果：因为非零环绕数规则的话在那一块位置表示的是2个独立的三角形，所以两者取并，所以出现问题。
	

####第六章
几何变换：图形的几何信息通过平移、比例、旋转等变换后产生的新图形。

齐次坐标：

- 原因：n维空间中较难解决的问题在n+1维中就很容易解决。
- 对于n维点（p1,p2,p3,...,pn）的齐次坐标为（hp1,hp2,hp3,...,hpn,h）
- 规范化齐次坐标表示h为1的时候。

**二维变换矩阵：**控制XX，XX变换？

二维空间中的点:P(x,y)转化为[x y 1]的矩阵则对齐进行变换的时候为[x' y' 1] = [x y 1]T2D = 
[x y z]*

|a|b|p|
|-|-|-|
|c|d|q|
|l|m|s|

其中T2D分为4个矩阵，T1 = 

|a|b|
|-|-|
|c|d|

控制比例、旋转、对称、错切等变换。
T2 = [l m]对图形进行平移变换

T3 = 

|p|
|-|
|q|

对图形进行投影变换

T4 = [s]对图形进行整体比例的变换。


**比例变换**

x缩放比例为Sx,y缩放比例为Sy，则T2D为

|Sx|0|0|
|-|-|-|
|0|Sy|0|
|0|0|1|

**整体变换**

S>1则整体缩小，0<S<1则整体放大，S<0则发生关于原点对称的等比例变换。

|1|0|0|
|-|-|-|
|0|1|0|
|0|0|S|

**旋转变换**

逆时针：

|cosΘ|sinΘ|0|
|-|-|-|
|-sinΘ|cosΘ|0|
|0|0|1|

顺时针

|cos(-Θ)|sin(-Θ)|0|
|-|-|-|
|-sin(-Θ)|cos(-Θ)|0|
|0|0|1|

当转角度很小的时候，cosΘ≈1，sinΘ≈Θ可以将旋转写为

|1|Θ|0|
|-|-|-|
|-Θ|1|0|
|0|0|1|

**镜像变换**

关于x轴对称

|1|0|0|
|-|-|-|
|0|-1|0|
|0|0|1|

关于y轴对称

|-1|0|0|
|-|-|-|
|0|1|0|
|0|0|1|

关于原点对称

|-1|0|0|
|-|-|-|
|0|-1|0|
|0|0|1|

关于x=y轴对称

|0|1|0|
|-|-|-|
|1|0|0|
|0|0|1|

关于y=-x对称

|0|-1|0|
|-|-|-|
|-1|0|0|
|0|0|1|

**错切变换**

|1|b|0|
|-|-|-|
|c|1|0|
|0|0|1|

当b = 0的时候沿x方向错切
当c = 0的时候沿y方向错切
当c ≠ 0，且b ≠ 0的时候，沿着x，y方向错切

**其他二维图案的变换：**

- 点的变换:[x' y' 1] = [x y 1]T
- 直线的变换:P' = PT，P如下图

|x0|y0|0|
|-|-|-|
|x1|y1|0|


- 多边形同上，即多个点的集合的矩阵

**复合变换**

T = T1 * T1 * T3 * ... * Tn

> 由于满足结合律: P' = PT1T2T3...Tn = P(T1T2T3...Tn)

> 由于矩阵乘法不满足交换律：T1T2≠T2T1，但是在某些特殊情况下：如连续平移，连续旋转，连续比例变换，连续缩放，均可交换。

**坐标系的变换**

坐标系的变换即对所有点进行平移和旋转

**裁剪**

- 直线段的裁剪
	- Cohen-Sutherland 裁剪算法
		1. 输入直线段两端端点p1(x1,y1),p2(x2,y2)，四条边界的坐标ywt,ywb,xwl,xwr
		2. 对p1和p2进行编码，P1的编码为code1，p2的编码为code2
		3. 若code1 | code2 = 0，对P1P2“简取”之，然后转到6，若code1 & code2 ≠ 0，对直线段“简弃”之，然后转到7，如果均不满足，昨天跳转到下一步
		4. 确保P1点在外部，否则交换P1,P2的坐标值和编码
		5. 根据P1的编码中1的位置，找到对应窗口那一侧区域上面的点S，去掉P1S然后转到2
		6. 用**直线扫描转换算法**画出当前的直线段P1P2.
		7. 算法结束
	- 中线分割算法：通过二分法快速确定边界点
		1. 同上求出code，然后检测点P2是否在窗口内，如果是，那么P2就是所求的点
		2. 检测P1,P2是否在同义词，如果是，则直线不在窗口内，直接返回。
		3. 求出P1P2的中点P3
		4. 检测P3与窗口的关系，如果P3在窗口内，用P3代替P1，重复3；如果P3不在窗口内，判断P3与P2之间的关系，如果P3和P2在窗口的同侧外面，则用P3代替点P2，丢掉P2,P3，如果P3与P2不在窗口的同侧外面，则用P3代替P1点，重复步骤3
		5. 直到算出两个在内部或者在边界上的店，从而确定是所需要截取的点。
		
- 多边形的裁剪
	- Sutherland-Hodgeman 多边形裁剪：根据边界进行裁剪，一般为左、下、右、上
		1. S在不可见侧，P在可见侧：输出与侧边交点I，P
		2. S在可见侧，P在可见侧：输出P
		3. S在可见侧，P在不可见侧：输出交点I
		4. S在不可见侧，P在不可见侧：不输出
		5. 每一次输出直接作为下一次的输入，从而减少变量的储存
	- Weiler-Atherton 多边形裁剪，Pw为窗口，Ps为用户定义的多边形
		1. 若从窗外进入窗内，则输出可见线段。
		2. 若从窗口内到窗口外，则从交点开始，沿着窗口Pw检测的变，即用窗口的有效边界去裁剪Ps的边，找到Ps与Pw最靠近当前交点的另一交点。
		3. 沿着Ps处理各个变，知道Ps的每一条变处理完毕，回到起点为止。
		
#### 第七章 三位变换及三位观察
基本与二维变换类似，但是其中的T为T3D

|a|b|c|p|
|-|-|-|-|
|d|e|f|q|
|g|h|i|r|
|l|m|n|s|

其中
T1作用是对点进行比例、对称、旋转、错切变换，为

|a|b|c|
|-|-|-|
|d|e|f|
|g|h|i|

T2作用是对点进行评议变换，为[l m n]
T3作用是对点进行透视投影变换，为

|p|
|-|
|q|
|r|

T4作用是对点进行整体比例变换，为[s]

**平移变换**

|1|0|0|0|
|-|-|-|-|
|0|1|0|0|
|0|0|1|0|
|Tx|Ty|Tz|1|

变换后的齐次坐标为[x+Tx y+Ty z+Tz 1]

**比例变换**

|a|0|0|0|
|-|-|-|-|
|0|e|0|0|
|0|0|i|0|
|0|0|0|1|

变换后的三维齐次坐标为[ax ey iz 1]

**整体比例变换**

|1|0|0|0|
|-|-|-|-|
|0|1|0|0|
|0|0|1|0|
|0|0|0|s|

变换后的齐次坐标为[x/s y/s z/s 1]

s≥1时，图形整体缩小，0<s<1时，图形整体放大，s<0时关于原点作对称等比变换

**旋转变换**

**绕z轴**

|cosΘ|sinΘ|0|0|
|-|-|-|-|
|-sinΘ|cosΘ|0|0|
|0|0|1|0|
|0|0|0|1|

变换后的齐次坐标为：[xcosΘ-ysinΘ xsinΘ+ycosΘ z 1]

**绕x轴**

|1|sinΘ|0|0|
|-|-|-|-|
|0|cosΘ|sinΘ|0|
|0|-sinΘ|cosΘ|0|
|0|0|0|1|

变换后的齐次坐标为：[x ycosΘ-zcosΘ ysinΘ+zcosΘ 1]

**绕y轴**

|cosΘ|0|-sinΘ|0|
|-|-|-|-|
|0|1|0|0|
|sinΘ|0|cosΘ|0|
|0|0|0|1|

变换后的齐次坐标为：[zsinΘ y zcosΘ-xsinΘ 1]

**对称变换**

**关于xOy变换**

|1|0|0|0|
|-|-|-|-|
|0|1|0|0|
|0|0|-1|0|
|0|0|0|1|

变换后的齐次坐标：[x y -z 1]

**关于yOz变换**

|-1|0|0|0|
|-|-|-|-|
|0|1|0|0|
|0|0|1|0|
|0|0|0|1|

变换后的齐次坐标：[-x y z 1]


**关于xOz变换**

|1|0|0|0|
|-|-|-|-|
|0|-1|0|0|
|0|0|1|0|
|0|0|0|1|

变换后的齐次坐标：[x -y z 1]

关于坐标轴对称

**关于x轴变换**

|1|0|0|0|
|-|-|-|-|
|0|-1|0|0|
|0|0|-1|0|
|0|0|0|1|

变换后的齐次坐标：[x -y -z 1]

**关于y变换**

|-1|0|0|0|
|-|-|-|-|
|0|1|0|0|
|0|0|-1|0|
|0|0|0|1|

变换后的齐次坐标：[-x y -z 1]

**关于z变换**

|-1|0|0|0|
|-|-|-|-|
|0|-1|0|0|
|0|0|1|0|
|0|0|0|1|

变换后的齐次坐标：[-x -y z 1]

**关于原点变换**

|-1|0|0|0|
|-|-|-|-|
|0|-1|0|0|
|0|0|-1|0|
|0|0|0|1|

变换后的齐次坐标：[-x -y -z 1]

**错切变换**

|1|b|c|0|
|-|-|-|-|
|d|1|f|0|
|g|h|1|0|
|0|0|0|1|

变换后的齐次坐标：[x+dy+gz bx+y+hz cx+fy+z 1]

**沿x方向错切：**b=c=f=h=0
**沿y方向错切：**d=c=g=f=0
**沿z方向错切：**b=d=g=h=0

**逆变换**：T^-1

1. 平移逆变换：将Tx,Ty,Tz变为-Tx,-Ty,-Tz
2. 比例变换的逆变换：a,b,c变为1/a,1/b,1/c
3. 整体比例变换的逆变换：s变为1/s
4. 旋转的逆变换：Θ变为-Θ


**三维复合变换**

基本上和二维变换一样

主要思路：TrAB = TtA * Trx * Try * Trz * Try^-1 * Trx^-1 * TtA^-1

1. 用任意方向轴的起点与坐标原点重合，此时进行平移变换。
2. 使方向轴与某一坐标重合，此时需进行旋转变换，切旋转变换可能不止一次
3. 针对该坐标轴变成变换
4. 用你旋转变换是方向轴回到其原始方向
5. 用逆平移变换使方向轴回到其原始位置。

**三视图**

**主视图**

|1|0|0|0|
|-|-|-|-|
|0|0|0|0|
|0|0|1|0|
|0|0|0|1|

变换后齐次坐标[x 0 z 1]

**俯视图**

|1|0|0|0|
|-|-|-|-|
|0|1|0|0|
|0|0|0|0|
|0|0|0|1|

但是为了能够和主视图在同一平面中，则需要进行Txoy Trx Ttz变换，最后得到的齐次坐标为[x 0 0(y+z0) 1]

**侧视图**

|0|0|0|0|
|-|-|-|-|
|0|1|0|0|
|0|0|1|0|
|0|0|0|1|

同理，为了在同一平面内，需要进行Tyoz Trz Ttx转换，最后得到的齐次坐标为[-(y+x0) 0 z 1]

**正轴测图**：对任意平面作投影，常用的为正等测图，正二测图，正三测图

基本的正等测图如P199中图7-14所示

T = Try Trx Tp（y轴顺时针转α角，x轴转β角，向xOy面作正投影），得到：

|cosα|-sinα * sinβ|0|0|
|----|------------|-|-|
|0|cosβ|0|0|
|-sinα|-cosα * sinβ|0|0|
|0|0|0|1|

**正等测图：**中α=45°，sinα=cosα=(√2)/2,sinβ=(√3)/3,cosβ=(√6)/3
**正二测图：**中α=45°，sinα=cosα=(√2)/2
**正三测图：**中α，β均不确定。

**透视投影**

灭点：不平行于投影面的平行线的投影会在透视投影的过程中会汇聚到一个点，这个点成为**灭点**，而坐标轴方向的平行线在投影面上形成的灭点成为**主灭点**

根据灭点透视分为**一点透视、两点透视、三点透视**

一点透视：
输入l,m.n和视距d，带入下面这个T，之后对三维物体进行矩阵变换，得到头时候的店。
T = [(x+l)/((d+n+z)/d) (y+m)/((d+n+z)/d) 0 1]








